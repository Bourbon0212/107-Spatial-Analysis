###空間分析　 作業2
####地理二　B06208001　龔泓愷

> Q2：繪製一張圖表，比較各行政區的麥當勞與肯德基在90-99年的規模變遷趨勢；並解釋其圖表呈現的意涵。

```{r results='hide', message = F, warning = F}
library(ggplot2)
library(rgdal)
library(tidyr)
library(dplyr)
FastFood <- readOGR(dsn = "./data", layer = "Tpe_Fastfood", encoding="utf8")
```
```{r warning = F}
data <- FastFood@data
# change from factor to numeric
data$TYPE_90 <- as.numeric(as.character(data$TYPE_90))
data$TYPE_99 <- as.numeric(as.character(data$TYPE_99))
# calculate the change
data$CHANGE <- (data$TYPE_99 - data$TYPE_90)
# assign larger smaller or the same
data_done <- data %>%
  mutate(STATUS = case_when(
    STORE == 'KFC' & CHANGE < 0 ~ 'kfc_small',
    STORE == 'KFC' & CHANGE == 0 ~ 'kfc_same',
    STORE == 'KFC' & CHANGE > 0 ~ 'kfc_large',
    STORE == 'MIC' & CHANGE < 0 ~ 'mic_small',
    STORE == 'MIC' & CHANGE == 0 ~ 'mic_same',
    STORE == 'MIC' & CHANGE > 0 ~ 'mic_large'
  ))
#plot
ggplot(data_done, aes(x = TOWN, fill = STATUS)) +
  geom_bar() +
  scale_x_discrete('行政區') + scale_y_continuous('間數') +
  scale_fill_discrete('銷售規模變化', labels = c('肯德基 提升', '肯德基 持平', '肯德基 減少', '麥當勞 增加', '麥當勞 持平', '麥當勞 減少')) +
  ggtitle('台北市各行政區速食店銷售規模變化趨勢圖')
```